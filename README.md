# 🌐 HarmarHttpServer

**HarmarHttpServer** 是一个用 Java 开发的轻量级 HTTP 服务器，具有 🚦 路由系统、📂 静态文件服务、🛡️ 安全防护 和 📊 性能监控 等功能。

---

## 🚀 主要功能

- ⚙️ **HTTP方法支持**：GET、POST、HEAD
- 🧭 **灵活的路由系统**：支持静态路由和参数化路由（如 `/api/user/{id}`）
- 📁 **静态文件服务**：高效的文件缓存机制，支持大文件服务
- 🛡️ **安全防护**：内置 DOS 防御机制，防止暴力请求攻击
- 📈 **性能监控**：实时跟踪请求数、响应时间、并发连接等指标
- 🔍 **监控端点**：提供 API 以获取服务器运行状态和性能数据
- 🔗 **连接管理**：支持持久连接和连接池管理
- 🧾 **HTTP头部处理**：支持 Host 头和 Cookie 解析

---

## 🧩 核心组件

### 1️⃣ 服务器核心 (HarmarHttpServer)
主要的服务器类，负责初始化组件、监听端口、处理请求等核心功能。

### 2️⃣ 请求处理
- 📥 **HttpRequest**：封装 HTTP 请求信息
- 📤 **HttpResponse**：构建和发送 HTTP 响应
- 🧭 **Router**：路由注册和匹配系统
- 📝 **PostRequestHandler**：处理 POST 请求，支持表单和 JSON 数据
- 🧱 **HeadRequestHandler**：处理 HEAD 请求
- 🧾 **StdHeadersHandler**：处理标准 HTTP 头部

### 3️⃣ 文件服务
- 🗂️ **FileCacheManager**：高效的 LRU 文件缓存管理器，支持文件修改时间检查和缓存大小控制

### 4️⃣ 安全与监控
- 🛡️ **DosDefender**：DOS 攻击防御系统，基于时间窗口的请求限制
- ⏱️ **PerformanceMonitor**：性能监控系统，跟踪请求统计和响应时间
- 📡 **MonitorEndpoints**：提供监控 API 端点
- 🔌 **ConnectionManager**：管理客户端连接

---

## ⚡ 快速开始

### 🧰 编译与运行

1. 确保安装了 Java 开发环境和 Maven
2. 编译项目：
   ```bash
   mvn clean compile
   ```
3. 运行服务器：
   ```bash
   mvn exec:java -Dexec.mainClass="org.example.HarmarHttpServer"
   ```

### 🌍 默认端口和目录

- 🔢 默认端口：`8080`
- 📂 默认静态文件目录：当前工作目录

---

## 🔀 路由示例

服务器内置了以下路由示例：

| 方法 | 路径 | 功能描述 |
|------|------|-----------|
| 🟩 **GET** | `/api/time` | 返回当前时间 |
| 🟩 **GET** | `/api/user/{id}` | 根据 ID 获取用户信息（参数化路由示例） |
| 🟧 **POST** | `/api/echo` | 回显请求体 |
| 🟧 **POST** | `/api/login` | 处理登录请求 |
| 🟩 **GET** | `/api/data` | 返回模拟数据 |

---

## 🛡️ 安全特性

- 🚫 **DOS 防御**：自动限制来自单一 IP 的请求频率
- 🧱 **路径规范化**：防止路径遍历攻击
- 📏 **请求体大小限制**：默认限制为 1MB
- 🧾 **Content-Type 验证**：只接受指定的内容类型

---

## ⚙️ 性能优化

- 💾 **文件缓存**：减少磁盘 I/O 操作
- 🧵 **并发处理**：多线程处理请求
- 🔁 **连接复用**：支持 HTTP Keep-Alive

---

## 🧠 配置选项

通过构造函数参数可配置以下选项：

- 服务器端口
- 静态文件根目录
- 文件缓存大小与条目数
- DOS 防御参数（时间窗口、最大请求数）
- 性能监控设置

---

## 📡 监控端点

服务器提供内置的监控 API，可用于获取运行时统计信息与性能数据。

---

## ⚠️ 注意事项

- 💡 本服务器适合开发与测试环境，生产环境建议使用成熟 Web 服务器（如 Nginx / Apache）
- 🧰 默认配置可根据负载灵活调整
- 🔒 确保静态文件目录的权限设置合理

---

## 📜 许可证

**MIT License** 🪪  
